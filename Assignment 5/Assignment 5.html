<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <script src="https://code.jquery.com/jquery-3.3.1.js" integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.2.3/d3.min.js"></script>
  <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
  <script src="http://d3js.org/d3.v3.js"></script>
  <script src="http://d3pie.min.js"></script>
  <script src="http://d3js.org/d3.v3.min.js"></script>

  <link href="https://fonts.googleapis.com/css?family=Montserrat:300,400,500" rel="stylesheet">

  <title> Employment Rate Of Different Countries </title>
  <style>
    html,
    body,
    div,
    span,
    applet,
    object,
    iframe,
    h1,
    h2,
    h3,
    h4,
    h5,
    h6,
    p,
    blockquote,
    pre,
    a,
    abbr,
    acronym,
    address,
    big,
    cite,
    code,
    del,
    dfn,
    em,
    img,
    ins,
    kbd,
    q,
    s,
    samp,
    small,
    strike,
    strong,
    sub,
    sup,
    tt,
    var,
    b,
    u,
    i,
    center,
    dl,
    dt,
    dd,
    ol,
    ul,
    li,
    fieldset,
    form,
    label,
    legend,
    table,
    caption,
    tbody,
    tfoot,
    thead,
    tr,
    th,
    td,
    article,
    aside,
    canvas,
    details,
    embed,
    figure,
    figcaption,
    footer,
    header,
    hgroup,
    menu,
    nav,
    output,
    ruby,
    section,
    summary,
    time,
    mark,
    audio,
    video {
      margin: 0;
      padding: 0;
      border: 0;
      font-size: 100%;
      font: inherit;
      vertical-align: baseline;
      outline: none;
      -webkit-text-size-adjust: 100%;
      -webkit-box-sizing: border-box;
      -moz-box-sizing: border-box;
      box-sizing: border-box;
      font-family: 'Montserrat', sans-serif;
      font-weight: 400;
    }

    html {
      font-family: 'Montserrat', sans-serif;
      font-weight: 400;
    }

    body {
      background-color: #d3d3d3;
    }

    .brushed {
      fill: orange;
      stroke: darkorange;
      opacity: 1.0;
    }

    .non_brushed {
      fill: #404040;
      opacity: 0.5;
    }

    .chart {
      display: inline-block;
    }

    .dim {
      opacity: 0.3;
    }

    .arc text {
      font: 10px sans-serif;
      text-anchor: middle;
    }

    .arc path {
      stroke: #fff;
    }

    .areaUSA {
      opacity: 1;
      fill: #ff4000;
      clip-path: url(#clip);
    }

    .areaNZL {
      opacity: 1;
      fill: #ffbf00;
      clip-path: url(#clip);
    }

    .areaCAN {
      opacity: 1;
      fill: #ffff00;
      clip-path: url(#clip);
    }

    .areaFRA {
      opacity: 1;
      fill: #80ff00;
      clip-path: url(#clip);
    }

    .areaEU {
      opacity: 1;
      fill: #00bfff;
      clip-path: url(#clip);
    }

    .areaJPN {
      opacity: 1;
      fill: #ff00ff;
      clip-path: url(#clip);
    }

    .areaRUS {
      opacity: 1;
      fill: #000000;
      clip-path: url(#clip);
    }

    .areaKOR {
      opacity: 1;
      fill: #f8c6a1;
      clip-path: url(#clip);
    }

    /* .empty {
      fill:none;
      clip-path: url(#clip);
    } */

    .zoom {
      cursor: move;
      fill: none;
      pointer-events: all;
    }


    .key-dot {

      height: 50px;
      width: 40px;
      float: left;
    }

    .country-name {
      float: left;
      padding: 17px;
      width: 50px;

    }

    .legend {}

    .legend1 {
      background-color: white;
      width: 134px;
      float: left;
      margin-right: 20px;
      margin-bottom: 1rem;
      height: 50px;
      /* box-shadow: 4px 4px 10px grey; */
    }

    .legend>div:last-child {
      margin-right: 0;
    }

    .USA {
      background: #ff4000;
    }

    .NZL {
      background: #ffbf00;
    }

    .CAN {
      background: #ffff00;
    }

    .FRA {
      background: #80ff00;
    }

    .EU {
      background: #00bfff;
    }

    .JPN {
      background: #ff00ff;
    }

    .RUS {
      background: #000000;
    }

    .KOR {
      background: #f8c6a1;
    }

    .chart {
      background-color: white;
      float: left;
    }

    #sortButton {
      position: relative;
      top: 190px;
      left: 30px;
    }

    .title {
      font-size: 1.5rem;
      color: black;
      margin-top: 1rem;
      margin-bottom: 1rem;
      float: left;
      width: 100%;
      background-color: white;
      padding-left: 2rem;
      padding-top: 2rem;
      padding-bottom: 2rem;
    }

    .select {
      float: right;
      position: absolute;
      top: 45px;
      left: 77%;
      /* box-shadow: 4px 4px 10px grey; */
      width: 150px;
      height: 35px;
      padding-left: 10px;
    }

    #barchart {
      margin-bottom: 1rem;
      margin-right: 1rem;
      height: 732px;
    }

    #chart {
      margin-bottom: 1rem;
    }

    #chart2 {
      margin-bottom: 1rem;
    }

    #chart4 {
      margin-right: 1rem;
      margin-bottom: 1rem;
    }

    .chart {
      box-shadow: 4px 4px 10px grey;
    }

    .content {
      width: 1215px;
      margin: 0 auto;
    }

    .footer {
      float: left;
      background-color: white;
      padding-left: 2rem;
      padding-top: 2rem;
      padding-bottom: 2rem;
      width: 99.7%;
      box-shadow: 4px 4px 10px grey;

    }

    p1 {
      font-size: 1.2rem;
    }

    @media (max-width: 1215px) {
      .select {
        left: 1000px;
      }
    }
  </style>


</head>

<body>
  <div class="content">
    <div class="title">Does Education Help Students Get Employed?</div>
    <button id="sortButton" type="button">Sort value </button>

    <div class="legend">
      <div class="legend1">
        <div class="key-dot USA"></div>
        <p class="country-name">USA</p>
      </div>
      <div class="legend1">
        <div class="key-dot NZL"></div>
        <p class="country-name">NZL</p>
      </div>
      <div class="legend1">
        <div class="key-dot CAN"></div>
        <p class="country-name">CAN</p>
      </div>
      <div class="legend1">
        <div class="key-dot FRA"></div>
        <p class="country-name">FRA</p>
      </div>
      <div class="legend1">
        <div class="key-dot EU"></div>
        <p class="country-name">EU</p>
      </div>
      <div class="legend1">
        <div class="key-dot JPN"></div>
        <p class="country-name">JPN</p>
      </div>
      <div class="legend1">
        <div class="key-dot KOR"></div>
        <p class="country-name">KOR</p>
      </div>
      <div class="legend1">
        <div class="key-dot RUS"></div>
        <p class="country-name">RUS</p>
      </div>
    </div>

    <div class="chart" id="barchart"></div>
    <div class="chart" id="chart"></div>
    <div class="chart" id="chart2"></div>
    <div class="chart" id="chart3"></div>

    <div class="chart" id="chart4">
      <svg width="770" height="450"></svg>
    </div>

    <div class="chart" id="chart5">
    </div>

    <div class="footer">
      <p1>IAT 355 Introduction to Visual Analytics: Final Project </p1>
      <p>By: Wade Liu, Eldwin Xu</p>
    </div>
  </div>
</body>
<script src="scatterplot.js"></script>
<script src="scatterplot2.js"></script>
<script src="scatterplot3.js"></script>
<script src="barchart.js"></script>
<script src="https://d3js.org/d3.v4.min.js"></script>

<script>
  // use local file
  var url = "http://www.sfu.ca/~wadel/iat355/EDEmployment.csv";

  var scatterchart = scatterChart()
    .width(426)
    .height(230);

  var scatterchart2 = scatterChart2()
    .width(426)
    .height(230);

  var scatterchart3 = scatterChart3()
    .width(426)
    .height(230);
  var parseTime = d3.timeParse("%Y");
  var bargraph = new barChart().width(650).height(350);

  d3.csv(url)
    .row(function(d) {

      d['country'] = d['country'];
      d['time'] = d['time'];
      d['EM_Try'] = +d['Em_Try'];
      d['Em_Upp'] = +d['Em_Upp'];
      d['Em_Bupp'] = +d['Em_Bupp'];
      d['E_Avg'] = +d['E_Avg'];
      d['Ed_Upp'] = +d['Ed_Upp'];
      d['Ed_Try'] = +d['Ed_Try'];
      d['Ed_Bupp'] = +d['Ed_Bupp'];
      d['gdp'] = +d['gdp'];


      return d;
    })

    .get(function(dataset) {

      var sortValues = false;
      bargraph(d3.select("#barchart"), dataset);

      bargraph.onClick = function(selection) {
        scatterchart.highlightcountry(selection);
        scatterchart2.highlightcountry(selection);
        scatterchart3.highlightcountry(selection);
        update(selection);
        updatePie(selection);
        console.log(selection);
      }

      bargraph.onDblClick = function(selection) {
        scatterchart.highlightcountry();
        scatterchart2.highlightcountry();
        scatterchart3.highlightcountry();
        updateAll();
        updatePieAll();

      }

      $("#sortButton").click(function(evt) {
        sortValues = !sortValues;
        bargraph.sort(sortValues)
      })

      scatterchart(d3.select("#chart"), dataset);

      scatterchart.onBrushData = function(data) {
        bargraph.updateChart(data);
      }

      scatterchart2(d3.select("#chart2"), dataset);

      scatterchart2.onBrushData = function(data) {
        bargraph.updateChart(data);
      }

      scatterchart3(d3.select("#chart3"), dataset);
      scatterchart3.onBrushData = function(data) {
        bargraph.updateChart(data);
      }
    });



  //line diagram
  var country = ["ALL", "USA", "NZL", "CAN", "FRA", "EU", "JPN", "RUS", "KOR"];

  var select = d3.select('body')
    .append('select')
    .attr('class', 'select')
    .on('change', onchange)

  var options = select
    .selectAll('option')
    .data(country).enter()
    .append('option')
    .text(function(d) {
      return d;
    });

  function onchange() {
    selectValue = d3.select('select').property('value')
    update(selectValue);
    updatePie(selectValue);
    scatterchart.highlightcountry(selectValue);
    scatterchart2.highlightcountry(selectValue);
    scatterchart3.highlightcountry(selectValue);
    if (selectValue == "ALL") {
      scatterchart.highlightcountry();
      scatterchart2.highlightcountry();
      scatterchart3.highlightcountry();
    }

  };

  var svg = d3.select("svg"),
    margin = {
      top: 90,
      right: 50,
      bottom: 160,
      left: 100
    },
    margin2 = {
      top: 320,
      right: 50,
      bottom: 80,
      left: 100
    },
    width = +svg.attr("width") - margin.left - margin.right,
    height = +svg.attr("height") - margin.top - margin.bottom,
    height2 = +svg.attr("height") - margin2.top - margin2.bottom;

  var parseDate = d3.timeParse("%Y");

  var x = d3.scaleTime().range([0, width]),
    x2 = d3.scaleTime().range([0, width]),
    y = d3.scaleLinear().range([height, 0]),
    y2 = d3.scaleLinear().range([height2, 0]);

  var xAxis = d3.axisBottom(x),
    xAxis2 = d3.axisBottom(x2),
    yAxis = d3.axisLeft(y);

  var brush = d3.brushX()
    .extent([
      [0, 0],
      [width, height2]
    ])
    .on("brush end", brushed);

  var areaUSA = d3.area()
    .curve(d3.curveMonotoneX)
    .x(function(d) {
      return x(d.time);
    })
    .y0(function(d) {
      return y(d.USAavg) + 1;
    })
    .y1(function(d) {
      return y(d.USAavg);
    });

  var areaNZL = d3.area()
    .curve(d3.curveMonotoneX)
    .x(function(d) {
      return x(d.time);
    })
    .y0(function(d) {
      return y(d.NZLavg) + 1;
    })
    .y1(function(d) {
      return y(d.NZLavg);
    });

  var areaCAN = d3.area()
    .curve(d3.curveMonotoneX)
    .x(function(d) {
      return x(d.time);
    })
    .y0(function(d) {
      return y(d.CANavg) + 1;
    })
    .y1(function(d) {
      return y(d.CANavg);
    });

  var areaFRA = d3.area()
    .curve(d3.curveMonotoneX)
    .x(function(d) {
      return x(d.time);
    })
    .y0(function(d) {
      return y(d.FRAavg) + 1;
    })
    .y1(function(d) {
      return y(d.FRAavg);
    });

  var areaEU = d3.area()
    .curve(d3.curveMonotoneX)
    .x(function(d) {
      return x(d.time);
    })
    .y0(function(d) {
      return y(d.EUavg) + 1;
    })
    .y1(function(d) {
      return y(d.EUavg);
    });

  var areaJPN = d3.area()
    .curve(d3.curveMonotoneX)
    .x(function(d) {
      return x(d.time);
    })
    .y0(function(d) {
      return y(d.JPNavg) + 1;
    })
    .y1(function(d) {
      return y(d.JPNavg);
    });

  var areaRUS = d3.area()
    .curve(d3.curveMonotoneX)
    .x(function(d) {
      return x(d.time);
    })
    .y0(function(d) {
      return y(d.RUSavg) + 1;
    })
    .y1(function(d) {
      return y(d.RUSavg);
    });

  var areaKOR = d3.area()
    .curve(d3.curveMonotoneX)
    .x(function(d) {
      return x(d.time);
    })
    .y0(function(d) {
      return y(d.KORavg) + 1;
    })
    .y1(function(d) {
      return y(d.KORavg);
    });

  var areaNZL2 = d3.area()
    .curve(d3.curveMonotoneX)
    .x(function(d) {
      return x2(d.time);
    })
    .y0(function(d) {
      return y2(d.NZLavg) + 1;
    })
    .y1(function(d) {
      return y2(d.NZLavg);
    });

  var areaUSA2 = d3.area()
    .curve(d3.curveMonotoneX)
    .x(function(d) {
      return x2(d.time);
    })
    .y0(function(d) {
      return y2(d.USAavg) + 1;
    })
    .y1(function(d) {
      return y2(d.USAavg);
    });

  var areaCAN2 = d3.area()
    .curve(d3.curveMonotoneX)
    .x(function(d) {
      return x2(d.time);
    })
    .y0(function(d) {
      return y2(d.CANavg) + 1;
    })
    .y1(function(d) {
      return y2(d.CANavg);
    });

  var areaFRA2 = d3.area()
    .curve(d3.curveMonotoneX)
    .x(function(d) {
      return x2(d.time);
    })
    .y0(function(d) {
      return y2(d.FRAavg) + 1;
    })
    .y1(function(d) {
      return y2(d.FRAavg);
    });

  var areaEU2 = d3.area()
    .curve(d3.curveMonotoneX)
    .x(function(d) {
      return x2(d.time);
    })
    .y0(function(d) {
      return y2(d.EUavg) + 1;
    })
    .y1(function(d) {
      return y2(d.EUavg);
    });

  var areaJPN2 = d3.area()
    .curve(d3.curveMonotoneX)
    .x(function(d) {
      return x2(d.time);
    })
    .y0(function(d) {
      return y2(d.JPNavg) + 1;
    })
    .y1(function(d) {
      return y2(d.JPNavg);
    });

  var areaRUS2 = d3.area()
    .curve(d3.curveMonotoneX)
    .x(function(d) {
      return x2(d.time);
    })
    .y0(function(d) {
      return y2(d.RUSavg) + 1;
    })
    .y1(function(d) {
      return y2(d.RUSavg);
    });

  var areaKOR2 = d3.area()
    .curve(d3.curveMonotoneX)
    .x(function(d) {
      return x2(d.time);
    })
    .y0(function(d) {
      return y2(d.KORavg) + 1;
    })
    .y1(function(d) {
      return y2(d.KORavg);
    });


  svg.append("defs")
    .append("clipPath")
    .attr("id", "clip")
    .append("rect")
    .attr("width", width)
    .attr("height", height);

  var focus = svg.append("g")
    .attr("class", "focus")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

  var context = svg.append("g")
    .attr("class", "context")
    .attr("transform", "translate(" + margin2.left + "," + margin2.top + ")");

  d3.csv("http://www.sfu.ca/~eldwinx/355/test_data.csv", type, function(error, data) {
    if (error) throw error;

    x.domain(d3.extent(data, function(d) {
      return d.time;
    }));
    y.domain([0, d3.max(data, function(d) {
      return d.NZLavg;
    })]);
    x2.domain(x.domain());
    y2.domain(y.domain());


    focus.append("path")
      .datum(data)
      .attr("class", "areaUSA")
      .attr("d", areaUSA);

    focus.append("path")
      .datum(data)
      .attr("class", "areaNZL")
      .attr("d", areaNZL);

    focus.append("path")
      .datum(data)
      .attr("class", "areaCAN")
      .attr("d", areaCAN);

    focus.append("path")
      .datum(data)
      .attr("class", "areaFRA")
      .attr("d", areaFRA);

    focus.append("path")
      .datum(data)
      .attr("class", "areaEU")
      .attr("d", areaEU);

    focus.append("path")
      .datum(data)
      .attr("class", "areaJPN")
      .attr("d", areaJPN);

    focus.append("path")
      .datum(data)
      .attr("class", "areaRUS")
      .attr("d", areaRUS);

    focus.append("path")
      .datum(data)
      .attr("class", "areaKOR")
      .attr("d", areaKOR);

    focus.append("g")
      .attr("class", "axis axis--x")
      .attr("transform", "translate(0," + height + ")")
      .call(xAxis);

    focus.append("text")
      .attr("x", 310)
      .attr("y", 320)
      .attr("dy", "1em")
      .style("text-anchor", "end")
      .style("font-size", "18px")
      .text("Years");

    focus.append("g")
      .attr("class", "axis axis--y")
      .call(yAxis);

    focus.append("text")
      .attr("transform", "rotate(-90)")
      .attr("x", 10)
      .attr("y", -50)
      .attr("dy", "1em")
      .style("text-anchor", "end")
      .style("font-size", "18px")
      .text("Employment Percentage");


    focus.append("text")
      .attr("x", 280)
      .attr("y", -50)
      .attr("dy", "1em")
      .style("text-anchor", "middle")
      .style("font-size", "20px")
      .text("Average Employment Rate");

    context.append("path")
      .datum(data)
      .attr("class", "areaUSA")
      .attr("d", areaUSA2);

    context.append("path")
      .datum(data)
      .attr("class", "areaNZL")
      .attr("d", areaNZL2);

    context.append("path")
      .datum(data)
      .attr("class", "areaCAN")
      .attr("d", areaCAN2);

    context.append("path")
      .datum(data)
      .attr("class", "areaFRA")
      .attr("d", areaFRA2);

    context.append("path")
      .datum(data)
      .attr("class", "areaEU")
      .attr("d", areaEU2);

    context.append("path")
      .datum(data)
      .attr("class", "areaJPN")
      .attr("d", areaJPN2);

    context.append("path")
      .datum(data)
      .attr("class", "areaRUS")
      .attr("d", areaRUS2);

    context.append("path")
      .datum(data)
      .attr("class", "areaKOR")
      .attr("d", areaKOR2);

    context.append("g")
      .attr("class", "axis axis--x")
      .attr("transform", "translate(0," + height2 + ")")
      .call(xAxis2);

    context.append("g")
      .attr("class", "brush")
      .call(brush)
      .call(brush.move, x.range());

  });


  function brushed() {

    var s = d3.event.selection || x2.range();
    x.domain(s.map(x2.invert, x2));
    focus.select(".areaUSA").attr("d", areaUSA);
    focus.select(".areaNZL").attr("d", areaNZL);
    focus.select(".areaCAN").attr("d", areaCAN);
    focus.select(".areaFRA").attr("d", areaFRA);
    focus.select(".areaEU").attr("d", areaEU);
    focus.select(".areaJPN").attr("d", areaJPN);
    focus.select(".areaRUS").attr("d", areaRUS);
    focus.select(".areaKOR").attr("d", areaKOR);
    focus.select(".axis--x").call(xAxis);

  }

  function updateAll() {
    console.log("hi");
    svg.selectAll(".areaKOR").style("opacity", 1);
    svg.selectAll(".areaUSA").style("opacity", 1);
    svg.selectAll(".areaNZL").style("opacity", 1);
    svg.selectAll(".areaCAN").style("opacity", 1);
    svg.selectAll(".areaFRA").style("opacity", 1);
    svg.selectAll(".areaEU").style("opacity", 1);
    svg.selectAll(".areaRUS").style("opacity", 1);
    svg.selectAll(".areaJPN").style("opacity", 1);

    svg.selectAll(".areaKOR2").style("opacity", 1);
    svg.selectAll(".areaUSA2").style("opacity", 1);
    svg.selectAll(".areaNZL2").style("opacity", 1);
    svg.selectAll(".areaCAN2").style("opacity", 1);
    svg.selectAll(".areaFRA2").style("opacity", 1);
    svg.selectAll(".areaEU2").style("opacity", 1);
    svg.selectAll(".areaRUS2").style("opacity", 1);
    svg.selectAll(".areaJPN2").style("opacity", 1);
  }

  function update(selectValue) {
    if (selectValue == "USA") { // user selected somting
      console.log("hi");
      svg.selectAll(".areaUSA").style("opacity", 1);
      svg.selectAll(".areaNZL").style("opacity", 0);
      svg.selectAll(".areaCAN").style("opacity", 0);
      svg.selectAll(".areaFRA").style("opacity", 0);
      svg.selectAll(".areaEU").style("opacity", 0);
      svg.selectAll(".areaJPN").style("opacity", 0);
      svg.selectAll(".areaRUS").style("opacity", 0);
      svg.selectAll(".areaKOR").style("opacity", 0);

      svg.selectAll(".areaUSA2").style("opacity", 1);
      svg.selectAll(".areaNZL2").style("opacity", 0);
      svg.selectAll(".areaCAN2").style("opacity", 0);
      svg.selectAll(".areaFRA2").style("opacity", 0);
      svg.selectAll(".areaEU2").style("opacity", 0);
      svg.selectAll(".areaJPN2").style("opacity", 0);
      svg.selectAll(".areaRUS2").style("opacity", 0);
      svg.selectAll(".areaKOR2").style("opacity", 0);
    } else if (selectValue == "NZL") { // user selected somting
      console.log("hi");
      svg.selectAll(".areaNZL").style("opacity", 1);
      svg.selectAll(".areaUSA").style("opacity", 0);
      svg.selectAll(".areaCAN").style("opacity", 0);
      svg.selectAll(".areaFRA").style("opacity", 0);
      svg.selectAll(".areaEU").style("opacity", 0);
      svg.selectAll(".areaJPN").style("opacity", 0);
      svg.selectAll(".areaRUS").style("opacity", 0);
      svg.selectAll(".areaKOR").style("opacity", 0);

      svg.selectAll(".areaNZL2").style("opacity", 1);
      svg.selectAll(".areaUSA2").style("opacity", 0);
      svg.selectAll(".areaCAN2").style("opacity", 0);
      svg.selectAll(".areaFRA2").style("opacity", 0);
      svg.selectAll(".areaEU2").style("opacity", 0);
      svg.selectAll(".areaJPN2").style("opacity", 0);
      svg.selectAll(".areaRUS2").style("opacity", 0);
      svg.selectAll(".areaKOR2").style("opacity", 0);
    } else if (selectValue == "CAN") { // user selected somting
      console.log("hi");
      svg.selectAll(".areaCAN").style("opacity", 1);
      svg.selectAll(".areaUSA").style("opacity", 0);
      svg.selectAll(".areaNZL").style("opacity", 0);
      svg.selectAll(".areaFRA").style("opacity", 0);
      svg.selectAll(".areaEU").style("opacity", 0);
      svg.selectAll(".areaJPN").style("opacity", 0);
      svg.selectAll(".areaRUS").style("opacity", 0);
      svg.selectAll(".areaKOR").style("opacity", 0);

      svg.selectAll(".areaCAN2").style("opacity", 1);
      svg.selectAll(".areaUSA2").style("opacity", 0);
      svg.selectAll(".areaNZL2").style("opacity", 0);
      svg.selectAll(".areaFRA2").style("opacity", 0);
      svg.selectAll(".areaEU2").style("opacity", 0);
      svg.selectAll(".areaJPN2").style("opacity", 0);
      svg.selectAll(".areaRUS2").style("opacity", 0);
      svg.selectAll(".areaKOR2").style("opacity", 0);
    } else if (selectValue == "FRA") { // user selected somting
      console.log("hi");
      svg.selectAll(".areaFRA").style("opacity", 1);
      svg.selectAll(".areaUSA").style("opacity", 0);
      svg.selectAll(".areaNZL").style("opacity", 0);
      svg.selectAll(".areaCAN").style("opacity", 0);
      svg.selectAll(".areaEU").style("opacity", 0);
      svg.selectAll(".areaJPN").style("opacity", 0);
      svg.selectAll(".areaRUS").style("opacity", 0);
      svg.selectAll(".areaKOR").style("opacity", 0);

      svg.selectAll(".areaFRA2").style("opacity", 1);
      svg.selectAll(".areaUSA2").style("opacity", 0);
      svg.selectAll(".areaNZL2").style("opacity", 0);
      svg.selectAll(".areaCAN2").style("opacity", 0);
      svg.selectAll(".areaEU2").style("opacity", 0);
      svg.selectAll(".areaJPN2").style("opacity", 0);
      svg.selectAll(".areaRUS2").style("opacity", 0);
      svg.selectAll(".areaKOR2").style("opacity", 0);
    } else if (selectValue == "EU") { // user selected somting
      console.log("hi");
      svg.selectAll(".areaEU").style("opacity", 1);
      svg.selectAll(".areaUSA").style("opacity", 0);
      svg.selectAll(".areaNZL").style("opacity", 0);
      svg.selectAll(".areaCAN").style("opacity", 0);
      svg.selectAll(".areaFRA").style("opacity", 0);
      svg.selectAll(".areaJPN").style("opacity", 0);
      svg.selectAll(".areaRUS").style("opacity", 0);
      svg.selectAll(".areaKOR").style("opacity", 0);

      svg.selectAll(".areaEU2").style("opacity", 1);
      svg.selectAll(".areaUSA2").style("opacity", 0);
      svg.selectAll(".areaNZL2").style("opacity", 0);
      svg.selectAll(".areaCAN2").style("opacity", 0);
      svg.selectAll(".areaFRA2").style("opacity", 0);
      svg.selectAll(".areaJPN2").style("opacity", 0);
      svg.selectAll(".areaRUS2").style("opacity", 0);
      svg.selectAll(".areaKOR2").style("opacity", 0);
    } else if (selectValue == "JPN") { // user selected somting
      console.log("hi");
      svg.selectAll(".areaJPN").style("opacity", 1);
      svg.selectAll(".areaUSA").style("opacity", 0);
      svg.selectAll(".areaNZL").style("opacity", 0);
      svg.selectAll(".areaCAN").style("opacity", 0);
      svg.selectAll(".areaFRA").style("opacity", 0);
      svg.selectAll(".areaEU").style("opacity", 0);
      svg.selectAll(".areaRUS").style("opacity", 0);
      svg.selectAll(".areaKOR").style("opacity", 0);

      svg.selectAll(".areaJPN2").style("opacity", 1);
      svg.selectAll(".areaUSA2").style("opacity", 0);
      svg.selectAll(".areaNZL2").style("opacity", 0);
      svg.selectAll(".areaCAN2").style("opacity", 0);
      svg.selectAll(".areaFRA2").style("opacity", 0);
      svg.selectAll(".areaEU2").style("opacity", 0);
      svg.selectAll(".areaRUS2").style("opacity", 0);
      svg.selectAll(".areaKOR2").style("opacity", 0);
    } else if (selectValue == "RUS") { // user selected somting
      console.log("hi");
      svg.selectAll(".areaRUS").style("opacity", 1);
      svg.selectAll(".areaUSA").style("opacity", 0);
      svg.selectAll(".areaNZL").style("opacity", 0);
      svg.selectAll(".areaCAN").style("opacity", 0);
      svg.selectAll(".areaFRA").style("opacity", 0);
      svg.selectAll(".areaEU").style("opacity", 0);
      svg.selectAll(".areaJPN").style("opacity", 0);
      svg.selectAll(".areaKOR").style("opacity", 0);

      svg.selectAll(".areaRUS2").style("opacity", 1);
      svg.selectAll(".areaUSA2").style("opacity", 0);
      svg.selectAll(".areaNZL2").style("opacity", 0);
      svg.selectAll(".areaCAN2").style("opacity", 0);
      svg.selectAll(".areaFRA2").style("opacity", 0);
      svg.selectAll(".areaEU2").style("opacity", 0);
      svg.selectAll(".areaJPN2").style("opacity", 0);
      svg.selectAll(".areaKOR2").style("opacity", 0);
    } else if (selectValue == "KOR") { // user selected somting
      console.log("hi");
      svg.selectAll(".areaKOR").style("opacity", 1);
      svg.selectAll(".areaUSA").style("opacity", 0);
      svg.selectAll(".areaNZL").style("opacity", 0);
      svg.selectAll(".areaCAN").style("opacity", 0);
      svg.selectAll(".areaFRA").style("opacity", 0);
      svg.selectAll(".areaEU").style("opacity", 0);
      svg.selectAll(".areaRUS").style("opacity", 0);
      svg.selectAll(".areaJPN").style("opacity", 0);

      svg.selectAll(".areaKOR2").style("opacity", 1);
      svg.selectAll(".areaUSA2").style("opacity", 0);
      svg.selectAll(".areaNZL2").style("opacity", 0);
      svg.selectAll(".areaCAN2").style("opacity", 0);
      svg.selectAll(".areaFRA2").style("opacity", 0);
      svg.selectAll(".areaEU2").style("opacity", 0);
      svg.selectAll(".areaRUS2").style("opacity", 0);
      svg.selectAll(".areaJPN2").style("opacity", 0);
    } else if (selectValue == "ALL") { // user selected somting
      console.log("hi");
      svg.selectAll(".areaKOR").style("opacity", 1);
      svg.selectAll(".areaUSA").style("opacity", 1);
      svg.selectAll(".areaNZL").style("opacity", 1);
      svg.selectAll(".areaCAN").style("opacity", 1);
      svg.selectAll(".areaFRA").style("opacity", 1);
      svg.selectAll(".areaEU").style("opacity", 1);
      svg.selectAll(".areaRUS").style("opacity", 1);
      svg.selectAll(".areaJPN").style("opacity", 1);

      svg.selectAll(".areaKOR2").style("opacity", 1);
      svg.selectAll(".areaUSA2").style("opacity", 1);
      svg.selectAll(".areaNZL2").style("opacity", 1);
      svg.selectAll(".areaCAN2").style("opacity", 1);
      svg.selectAll(".areaFRA2").style("opacity", 1);
      svg.selectAll(".areaEU2").style("opacity", 1);
      svg.selectAll(".areaRUS2").style("opacity", 1);
      svg.selectAll(".areaJPN2").style("opacity", 1);
    }


  }



  function type(d) {
    d.time = parseDate(d.time);
    d.USAavg = +d.USAavg;
    d.NZLavg = +d.NZLavg;
    d.CANavg = +d.CANavg;
    d.FRAavg = +d.FRAavg;
    d.EUavg = +d.EUavg;
    d.JPNavg = +d.JPNavg;
    d.RUSavg = +d.RUSavg;
    d.KORavg = +d.KORavg;
    d.empty = +d.empty;

    return d;
  }

  /*pie diagram*/
  var w = 426, //width
    h = 450, //height
    r = 180, //radius
    color = d3.scale.category20c(); //builtin range of colors




  data = [{
      "label": "University",
      "value": 37.81355
    },
    {
      "label": "Secondary",
      "value": 40.72356
    },
    {
      "label": "Below Secondary",
      "value": 21.46289
    }
  ];

  var vis = d3.select("#chart5")
    .append("svg:svg")
    .data([data])
    .attr("width", w)
    .attr("height", h)
    .append("svg:g")
    .attr("transform", "translate(" + w / 2 + "," + 250 + ")")


  var arc = d3.svg.arc()
    .outerRadius(r);

  var pie = d3.layout.pie()
    .value(function(d) {
      return d.value;
    });

  var arcs = vis.selectAll("g.slice")
    .data(pie)
    .enter()
    .append("svg:g")
    .attr("class", "slice");

  arcs.append("text")
    .attr("x", 0)
    .attr("y", -220)
    .attr("dy", "1em")
    .style("text-anchor", "middle")
    .style("font-size", "18px")
    .text("Average Education Level");

  arcs.append("svg:path")
    .attr("fill", function(d, i) {
      return color(i);
    })
    .attr("d", arc);

  arcs.append("svg:text")
    .attr("transform", function(d) {

      d.innerRadius = 0;
      d.outerRadius = r;
      return "translate(" + arc.centroid(d) + ")";
    })
    .attr("text-anchor", "middle")
    .text(function(d, i) {
      return data[i].label + ": " + data[i].value;
    });
  // .text(function(d, i) { return data[i].value; });


  function updatePie(selectValue) {
    console.log(data);
    if (selectValue == "USA") {
      data = [{
          "label": "University",
          "value": 38.897
        },
        {
          "label": "Secondary",
          "value": 48.898
        },
        {
          "label": "Below Secondary",
          "value": 12.205
        }
      ];
    }

    if (selectValue == "NZL") {
      data = [{
          "label": "University",
          "value": 31.8718
        },
        {
          "label": "Secondary",
          "value": 36.4035
        },
        {
          "label": "Below Secondary",
          "value": 31.7247
        }
      ];
    }

    if (selectValue == "CAN") {
      data = [{
          "label": "University",
          "value": 44.9014
        },
        {
          "label": "Secondary",
          "value": 39
        },
        {
          "label": "Below Secondary",
          "value": 16.0986
        }
      ];
    }

    if (selectValue == "FRA") {
      data = [{
          "label": "University",
          "value": 25.2363
        },
        {
          "label": "Secondary",
          "value": 41.2868
        },
        {
          "label": "Below Secondary",
          "value": 33.4769
        }
      ];
    }

    if (selectValue == "EU") {
      data = [{
          "label": "University",
          "value": 36.1652
        },
        {
          "label": "Secondary",
          "value": 36.5693
        },
        {
          "label": "Below Secondary",
          "value": 27.2655
        }
      ];
    }

    if (selectValue == "JPN") {
      data = [{
          "label": "University",
          "value": 40.7046
        },
        {
          "label": "Secondary",
          "value": 42.6088
        },
        {
          "label": "Below Secondary",
          "value": 16.6866
        }
      ];
    }

    if (selectValue == "KOR") {
      data = [{
          "label": "University",
          "value": 32.3865
        },
        {
          "label": "Secondary",
          "value": 41.6102
        },
        {
          "label": "Below Secondary",
          "value": 26.0033
        }
      ];
    }

    if (selectValue == "RUS") {
      data = [{
          "label": "University",
          "value": 52.3456
        },
        {
          "label": "Secondary",
          "value": 39.4119
        },
        {
          "label": "Below Secondary",
          "value": 8.2425
        }
      ];
    }

    if (selectValue == "ALL") {
      data = [{
          "label": "University",
          "value": 37.81355
        },
        {
          "label": "Secondary",
          "value": 40.72356
        },
        {
          "label": "Below Secondary",
          "value": 21.46289
        }
      ];
    }



    var vis = d3.select("#chart5").select("svg")
      .remove();

    var vis = d3.select("#chart5").select("p")
      .remove();

    var vis = d3.select("#chart5")
      .append("svg:svg")
      .data([data])
      .attr("width", w)
      .attr("height", h)
      .append("svg:g")
      .attr("transform", "translate(" + w / 2 + "," + 250 + ")")


    var arc = d3.svg.arc()
      .outerRadius(r);

    var pie = d3.layout.pie()
      .value(function(d) {
        return d.value;
      });

    var arcs = vis.selectAll("g.slice")
      .data(pie)
      .enter()
      .append("svg:g")
      .attr("class", "slice");

    arcs.append("svg:path")
      .attr("fill", function(d, i) {
        return color(i);
      })
      .attr("d", arc);

    arcs.append("text")
      .attr("x", 0)
      .attr("y", -220)
      .attr("dy", "1em")
      .style("text-anchor", "middle")
      .style("font-size", "18px")
      .text("Average Education Level For: " + selectValue);

    arcs.append("svg:text")
      .attr("transform", function(d) {

        d.innerRadius = 0;
        d.outerRadius = r;
        return "translate(" + arc.centroid(d) + ")";
      })
      .attr("text-anchor", "middle")
      .text(function(d, i) {
        return data[i].label + ": " + data[i].value;
      });



  }


  function updatePieAll() {
    data = [{
        "label": "University",
        "value": 37.81355
      },
      {
        "label": "Secondary",
        "value": 40.72356
      },
      {
        "label": "Below Secondary",
        "value": 21.46289
      }
    ];

    var vis = d3.select("#chart5").select("svg")
      .remove();

    var vis = d3.select("#chart5").select("p")
      .remove();

    var vis = d3.select("#chart5")
      .append("svg:svg")
      .data([data])
      .attr("width", w)
      .attr("height", h)
      .append("svg:g")
      .attr("transform", "translate(" + w / 2 + "," + h / 2 + ")")


    var arc = d3.svg.arc()
      .outerRadius(r);

    var pie = d3.layout.pie()
      .value(function(d) {
        return d.value;
      });

    var arcs = vis.selectAll("g.slice")
      .data(pie)
      .enter()
      .append("svg:g")
      .attr("class", "slice");

    arcs.append("svg:path")
      .attr("fill", function(d, i) {
        return color(i);
      })
      .attr("d", arc);

    arcs.append("svg:text")
      .attr("transform", function(d) {

        d.innerRadius = 0;
        d.outerRadius = r;
        return "translate(" + arc.centroid(d) + ")";
      })
      .attr("text-anchor", "middle")
      .text(function(d, i) {
        return data[i].label + ": " + data[i].value;
      });
  }
</script>

</html>